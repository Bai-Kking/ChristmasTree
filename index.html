<!--圣诞快乐饱饱！如果你能看到这个页面，说明你就素一个资深的程序员啦！-->
<!DOCTYPE html>
<html lang = "zh-CN">
<head>
    <meta charset = "UTF-8">
    <meta name = "viewport" content="width = device-width, initial-scale = 1.0">
    <title>Christmas Tree For You!</title>
    <script src = "https://cdn.tailwindcss.com"></script>
    <link href = "https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&display=swap" rel = "stylesheet">
    <style>
        body {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            margin: 0;
            height: 100vh;
            background-color: black;
            color: white;
            font-family: 'Courier Prime', monospace;
            overflow: hidden;
            user-select: none;
        }

        #TREE {
            position: relative;
            z-index: 10;
            text-align: center;
            line-height: 1.2;
            cursor: default;
        }

        .char {
            display: inline-block;
            margin: 0 0.5px;
            transition: color 0.5s ease;
        }

        .star { font-size: 1.5rem; }
        .heart { text-shadow: 0 0 8px currentColor; }
        .txt {
            margin-top: 2rem;
            font-size: 2rem;
            font-weight: bold;
            letter-spacing: 0.2rem;
            animation: shanshan 2s infinite ease-in-out;
            text-shadow: 0 0 10px white;
        }

        @keyframes shanshan {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }
        #snowCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }
    </style>
</head>
<body>
    
    <audio id = "bgm" loop muted>
        <source src = "https://precious-indigo-j5nugywt3o-1qtapqoe4v.edgeone.dev/M50000450F8H2BjbB3.mp3" type = "audio/mpeg">
    </audio>
    <script>
        document.addEventListener('click', function() {
            var audio = document.getElementById('bgm');
            audio.muted = false;
            audio.play();
        });
    </script>
    
    <canvas id = "snowCanvas"></canvas>
    
    <div id = "TREE">
        <div id = "trContent"></div>
        <div class = "txt">Merry Christmas!</div>
        <div class = "txt">圣诞快乐饱饱！</div>
    </div>

    <script>
        const colors = [
            '#FF3E3E', '#FF6B6B', '#FF9AA2', '#E53935', '#B71C1C', '#00C853', '#00E676', '#66FF66', '#2E7D32', '#1B5E20', '#FFD73E', '#FFC107', '#FFB300', '#FFA500', '#3E84FF', '#4FC3F7',
            '#2979FF', '#00BCD4', '#FF3EEF', '#F06292', '#AB47BC', '#7C4DFF', '#3EFFF9', '#FFFFFF'
        ];
        // DOM元素缓存
        const trContent = document.getElementById('trContent');
        function initTree() {
            let it = '';
            
            it += `<div class = "star"><span class = "char" style = "color: #00C853">★</span></div>`;
            
            for (let i = 0; i < 15; i++) {
                it += '<div class="row">';
                for (let j = 0; j < i * 2 + 1; j++) {
                    // 随机生成爱心
                    const is_heart = Math.random();
                    const char = is_heart > 0.91 ? '❤' : '*';
                    const rand = colors[Math.floor(Math.random() * colors.length)];
                    it += `<span class = "char ${is_heart ? 'heart' : ''}" style = "color: ${rand}">${char}</span>`;
                }
                it += '</div>';
            }
            
            for (let i = 0; i < 3; i++) {
                it += '<div class = "row">';
                for (let j = 0; j < 3; j++) {
                    const rand = colors[Math.floor(Math.random() * colors.length)];
                    it += `<span class = "char" style="color: ${rand}">*</span>`;
                }
                it += '</div>';
            }
            
            trContent.innerHTML = it;
        }

        
        function animateTree() {
            const tot = document.querySelectorAll('.char');
            // 随机变色
            tot.forEach(char => {
                if (Math.random() > 0.9) {
                    char.style.color = colors[Math.floor(Math.random() * colors.length)];
                }
            });
            setTimeout(animateTree, 200);
        }

        // 雪花特效
        function initSnow() {
            const snow_canvas = document.getElementById('snowCanvas');
            const pen = snow_canvas.getContext('2d');
            let width, height;
            let snowflakes = [];
            
            function re() {
                width = snow_canvas.width = window.innerWidth;
                height = snow_canvas.height = window.innerHeight;
            }

            // 生成雪花数组
            function create_snowflakes() {
                snowflakes = [];
                for (let i = 0; i < 100; i++) {
                    snowflakes.push({
                        x: Math.random() * width,
                        y: Math.random() * height,
                        r: Math.random() * 2 + 1,
                        s: Math.random() * 1 + 0.5,
                        o: Math.random() * 0.5 + 0.2
                    });
                }
            }

            function draw_snow() {
                // 清空
                pen.clearRect(0, 0, width, height);
                // 绘制
                snowflakes.forEach(flake => {
                    pen.beginPath();
                    pen.arc(flake.x, flake.y, flake.r, 0, Math.PI * 2);
                    pen.fillStyle = `rgba(255,255,255,${flake.o})`;
                    pen.fill();
                    // 雪花下落
                    flake.y += flake.s;
                    
                    if (flake.y > height) {
                        flake.y = -5;
                        flake.x = Math.random() * width;
                    }
                });
                requestAnimationFrame(draw_snow);
            }

            // 窗口变化
            window.addEventListener('resize', () => {
                re();
                create_snowflakes();
            });

            // 初始化
            re();
            create_snowflakes();
            draw_snow();
        }

        // 启动！
        window.onload = function() {
            initTree();
            animateTree();
            initSnow();
        };
    </script>
</body>
</html>
